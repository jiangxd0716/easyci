<h1>前言</h1>
<h3>系统环境：Centos7、jdk1.8</h3>
<p>私服是一种特殊的远程仓库，它是架设在局域网内的仓库服务，私服代理广域网上的远程仓库，供局域网内的用户使用。当Maven需要下载构件的时候，它从私服请求，如果 私服上不存在该构件，则从外部远程仓库下载，缓存在私服上之后，再为Maven的下载请求提供服务。</p>
<h1>安装</h1>
<h2>一、安装maven 3.6.1</h2>
<p>1. 下载maven</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #000000;"># wget下载maven3.6.1
</span><span style="color: #008080;"> 2</span> <span style="color: #000000;">[root@localhost home]#wget http://mirrors.tuna.tsinghua.edu.cn/apache/maven/maven-3/3.6.1/binaries/apache-maven-3.6.1-bin.tar.gz</span><span style="color: #008080;">20</span> 
<span style="color: #008080;">21</span> <span style="color: #000000;"># 解压maven
</span><span style="color: #008080;">22</span> <span style="color: #000000;">[root@localhost home]# tar -zxvf apache-maven-3.6.1-bin.tar.gz </span><span style="color: #008080;">27</span> 
<span style="color: #008080;">28</span> <span style="color: #000000;"># 重命名maven
</span><span style="color: #008080;">29</span> [root@localhost home]# mv apache-maven-3.6.1 maven</pre>
</div>
<p>2.设置maven环境变量</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #000000;"># 修改环境变量增加maven
</span><span style="color: #008080;">2</span> <span style="color: #000000;">[root@localhost home]# vi /etc/profile
</span><span style="color: #008080;">3</span> 
<span style="color: #008080;">4</span> <span style="color: #000000;">    export MAVEN_HOME=/home/maven
</span><span style="color: #008080;">5</span> <span style="color: #000000;">    export PATH=$MAVEN_HOME/bin:$PATH
</span><span style="color: #008080;">6</span> 
<span style="color: #008080;">7</span> <span style="color: #000000;"># 重载生效
</span><span style="color: #008080;">8</span> [root@localhost home]# source /etc/profile</pre>
</div>
<p>3.验证maven</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #000000;">[root@localhost home]# mvn -v
</span><span style="color: #008080;">2</span> <span style="color: #000000;">Apache Maven 3.6.1 (d66c9c0b3152b2e69ee9bac180bb8fcc8e6af555; 2019-04-05T03:00:29+08:00)
</span><span style="color: #008080;">3</span> <span style="color: #000000;">Maven home: /home/maven
</span><span style="color: #008080;">4</span> <span style="color: #000000;">Java version: 1.8.0_221, vendor: Oracle Corporation, runtime: /home/jdk/jre
</span><span style="color: #008080;">5</span> <span style="color: #000000;">Default locale: zh_CN, platform encoding: UTF-8
</span><span style="color: #008080;">6</span> OS name: "linux", version: "3.10.0-957.27.2.el7.x86_64", arch: "amd64", family: "unix"</pre>
</div>
<h2>二、安装Nexus3.11.0 maven私服</h2>
<p>1.下载</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #000000;"># wget下载nexus的tar包
</span><span style="color: #008080;">2</span> <span style="color: #000000;">[root@localhost home]# wget http://sonatype-download.global.ssl.fastly.net/nexus/3/nexus-3.6.0-02-unix.tar.gz
</span><span style="color: #008080;">3</span> 
<span style="color: #008080;">4</span> <span style="color: #000000;"># 解压
</span><span style="color: #008080;">5</span> <span style="color: #000000;">[root@localhost home]# tar -C nexus -zxvf nexus-3.6.0-02-unix.tar.gz<br /></span></pre>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #000000;">[root@localhost home]# cd nexus
</span><span style="color: #008080;">2</span> <span style="color: #000000;">[root@localhost nexus]# ls
</span><span style="color: #008080;">3</span> <span style="color: #000000;">nexus-3.6.0-02  sonatype-work
</span><span style="color: #008080;">4</span> <span style="color: #000000;">[root@localhost nexus]# mv nexus-3.6.0-02/ nexus
</span><span style="color: #008080;">5</span> 
<span style="color: #008080;">6</span> <span style="color: #000000;">[root@localhost nexus]# ls -l
</span><span style="color: #008080;">7</span> <span style="color: #000000;">总用量 0
</span><span style="color: #008080;">8</span> <span style="color: #000000;">drwxr-xr-x. 9 root root 136 9月  19 13:11 nexus
</span><span style="color: #008080;">9</span> drwxr-xr-x. 3 root root  20 9月  19 13:11 sonatype-work</pre>
</div>
</div>
<p>2.修改nexus端口号</p>
<p>修改etc目录下nexus-default.properties文件</p>
<p><img src="https://img2018.cnblogs.com/blog/1335688/201909/1335688-20190919132725837-1899700759.png" alt="" /></p>
<p>&nbsp;3.修改maven运行jvm</p>
<p>修改bin目录下的nexus.vmoptions文件</p>
<p><img src="https://img2018.cnblogs.com/blog/1335688/201909/1335688-20190919132915839-1312279260.png" alt="" /></p>
<p>&nbsp;4.启动私服</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #000000;">[root@localhost bin]# pwd
</span><span style="color: #008080;">2</span> <span style="color: #000000;">/home/nexus/nexus/bin
</span><span style="color: #008080;">3</span> <span style="color: #000000;">[root@localhost bin]# ./nexus start
</span><span style="color: #008080;">4</span> <span style="color: #000000;">WARNING: ************************************************************
</span><span style="color: #008080;">5</span> <span style="color: #000000;">WARNING: Detected execution as "root" user.  This is NOT recommended!
</span><span style="color: #008080;">6</span> <span style="color: #000000;">WARNING: ************************************************************
</span><span style="color: #008080;">7</span> Starting nexus</pre>
</div>
<p>此处警告：可以useradd nexus，然后chown -R nexus:nexus /home/nexus 然后重启nexus解决</p>
<p>nexus start|stop|status|restart</p>
<p>5.浏览器打开<a href="http://192.168.8.10:8002/">http://192.168.8.10:8002/</a>访问，默认密码admin/admin123。nexus启动很慢，耐心等待。</p>
<p><img src="https://img2018.cnblogs.com/blog/1335688/201909/1335688-20190919133353423-842069128.png" alt="" width="958" height="177" /></p>
<p><img src="https://img2018.cnblogs.com/blog/1335688/201909/1335688-20190919133701580-1530851035.png" alt="" /></p>
<p>登录发现警告&ldquo;System Requirement: max file descriptors [4096] likely too low, increase to at least [65536].&rdquo;</p>
<p>解决： vi&nbsp;/etc/security/limits.conf</p>
<p>在文件末尾增加</p>
<div class="cnblogs_code">
<p>*　　&nbsp; soft nofile 65536<br />* 　　              hard    nofile          65536<br />* 　　              soft    nproc           4096<br />* 　　              hard    nproc           4096</p>










</div>
<p>重启nexus解决。</p>
<p>6.创建java仓库</p>
<p><img src="https://img2018.cnblogs.com/blog/1335688/201909/1335688-20190919135356623-366404178.png" alt="" width="890" height="479" /></p>
<p>&nbsp;<img src="https://img2018.cnblogs.com/blog/1335688/201909/1335688-20190919135431645-314631483.png" alt="" /></p>
<p>&nbsp;这里选择 maven2（hosted）</p>
<p><img src="https://img2018.cnblogs.com/blog/1335688/201909/1335688-20190919135515453-260133108.png" alt="" /></p>
<p>&nbsp;maven配置：修改maven的settings.xml配置文件</p>
<pre>  &lt;!--nexus服务器--&gt;
  &lt;servers&gt;  
    &lt;server&gt;  
        &lt;id&gt;releases&lt;/id&gt;  
        &lt;username&gt;admin&lt;/username&gt;  
        &lt;password&gt;admin123&lt;/password&gt;  
    &lt;/server&gt;   </pre>
<pre>    &lt;server&gt;  
        &lt;id&gt;Snapshots&lt;/id&gt;  
        &lt;username&gt;admin&lt;/username&gt;  
        &lt;password&gt;admin123&lt;/password&gt;  
    &lt;/server&gt; </pre>
<pre>  &lt;/servers&gt;  
  &lt;!--组资源库的url地址  id和name自定义，mirrorOf的值设置为central，写死的--&gt;  
  &lt;mirrors&gt;   <br />　　<span style="color: #ff0000;">&lt;!-- </span> <br /><span style="color: #ff0000;">   #后续测试增加maven私服的配置后，无法拉取官方的jar包，注释掉解决问题
    &lt;mirror&gt;  
        &lt;id&gt;nexus&lt;/id&gt;  
        &lt;name&gt;java&lt;/name&gt;  
        &lt;url&gt;http://192.168.8.10:8002/repository/java/&lt;/url&gt;  
        &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;  
    &lt;/mirror&gt; <br />   --&gt;<br /></span> </pre>
<pre> 　　&lt;mirror&gt;  
        &lt;id&gt;alimaven&lt;/id&gt;  
        &lt;name&gt;aliyun maven&lt;/name&gt;  
        &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public/&lt;/url&gt;  
        &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;  
    &lt;/mirror&gt;</pre>
<pre>&nbsp; &lt;/mirrors&gt;&nbsp;&nbsp;<br /><br /></pre>
<div class="cnblogs_code">
<pre>&lt;profiles&gt;
  &lt;profile&gt;
   &lt;id&gt;jdk-<span style="color: #800080;">1.8</span>&lt;/id&gt;
           &lt;activation&gt;
               &lt;activeByDefault&gt;<span style="color: #0000ff;">true</span>&lt;/activeByDefault&gt;
               &lt;jdk&gt;<span style="color: #800080;">1.8</span>&lt;/jdk&gt;
           &lt;/activation&gt;
           &lt;properties&gt;
               &lt;maven.compiler.source&gt;<span style="color: #800080;">1.8</span>&lt;/maven.compiler.source&gt;
               &lt;maven.compiler.target&gt;<span style="color: #800080;">1.8</span>&lt;/maven.compiler.target&gt;
               &lt;maven.compiler.compilerVersion&gt;<span style="color: #800080;">1.8</span>&lt;/maven.compiler.compilerVersion&gt;
           &lt;/properties&gt;
   &lt;/profile&gt;

   &lt;profile&gt;
     &lt;id&gt;nexus-java&lt;/id&gt;
      &lt;!-- 远程仓库列表 --&gt;
   　&lt;repositories&gt;
     &lt;repository&gt;
      &lt;id&gt;java&lt;/id&gt;
      &lt;name&gt;Nexus Central&lt;/name&gt;
     &lt;!-- 虚拟的URL形式,指向镜像的URL--&gt;
      &lt;url&gt;http:<span style="color: #008000;">//</span><span style="color: #008000;">192.168.8.10:8002/repository/java/&lt;/url&gt;</span>
      &lt;layout&gt;<span style="color: #0000ff;">default</span>&lt;/layout&gt;
     &lt;!-- 表示可以从这个仓库下载releases版本的构件--&gt;  
      &lt;releases&gt;
        &lt;enabled&gt;<span style="color: #0000ff;">true</span>&lt;/enabled&gt;
      &lt;/releases&gt;
     &lt;!-- 表示可以从这个仓库下载snapshot版本的构件 --&gt;  
      &lt;snapshots&gt;
        &lt;enabled&gt;<span style="color: #0000ff;">true</span>&lt;/enabled&gt;
      &lt;/snapshots&gt;
    &lt;/repository&gt;
  &lt;/repositories&gt;
 &lt;!-- 插件仓库列表 --&gt;
  &lt;pluginRepositories&gt;
    &lt;pluginRepository&gt;
      &lt;id&gt;java&lt;/id&gt;
      &lt;name&gt;Nexus Central&lt;/name&gt;
      &lt;url&gt;http:<span style="color: #008000;">//</span><span style="color: #008000;">192.168.8.10:8002/repository/java/&lt;/url&gt;</span>
      &lt;layout&gt;<span style="color: #0000ff;">default</span>&lt;/layout&gt;
      &lt;snapshots&gt;
        &lt;enabled&gt;<span style="color: #0000ff;">true</span>&lt;/enabled&gt;
      &lt;/snapshots&gt;
      &lt;releases&gt;
         &lt;enabled&gt;<span style="color: #0000ff;">true</span>&lt;/enabled&gt;
      &lt;/releases&gt;
    &lt;/pluginRepository&gt;
  &lt;/pluginRepositories&gt;
   &lt;/profile&gt;
  &lt;/profiles&gt;

  &lt;activeProfiles&gt;
     &lt;!--需要激活 &lt;profile&gt;中的ID才生效--&gt;  
    &lt;activeProfile&gt;nexus-java&lt;/activeProfile&gt;
    &lt;activeProfile&gt;jdk-<span style="color: #800080;">1.8</span>&lt;/activeProfile&gt;
  &lt;/activeProfiles&gt;

  &lt;!--<span style="color: #000000;"> activeProfiles
   </span>| List of profiles that are active <span style="color: #0000ff;">for</span><span style="color: #000000;"> all builds.
   </span>|
  &lt;activeProfiles&gt;
    &lt;activeProfile&gt;alwaysActiveProfile&lt;/activeProfile&gt;
    &lt;activeProfile&gt;anotherAlwaysActiveProfile&lt;/activeProfile&gt;
  &lt;/activeProfiles&gt;</pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;maven私服其他仓库建立及调用过程请参考：<a href="https://www.cnblogs.com/kongweifeng/p/9369936.html">https://www.cnblogs.com/kongweifeng/p/9369936.html</a></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000;">&nbsp;常见错误问题：</span></p>
<p><span style="color: #ff0000;">1.未认证或认证失败：错误码401</span></p>
<div class="cnblogs_code">
<pre><span style="color: #000000;">[ERROR] Failed to execute goal org.apache.maven.plugins:maven-deploy-plugin:2.8.2:deploy (default-deploy) on project mingbytesiteapi: Failed to deploy artifacts: Could not transfer artifact cc.mrbird:mingbytesiteapi:jar:1.0.0 from/to releases (http://192.168.8.101:8002/repository/java/): Failed to transfer file http://192.168.8.10:8002/repository/java/cc/mrbird/mingbytesiteapi/1.0.0/mingbytesiteapi-1.0.0.ja<span style="color: #ff0000;">r with status code 401</span> -&gt; [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException1</span></pre>
</div>
<p>解决：maven的setting.xml配置文件中的server username和password未配置或者配置不正确</p>
<div class="cnblogs_code">
<pre> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">server</span><span style="color: #0000ff;">&gt;</span>  
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">id</span><span style="color: #0000ff;">&gt;</span>releases<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">id</span><span style="color: #0000ff;">&gt;</span>  
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">username</span><span style="color: #0000ff;">&gt;</span>admin<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">username</span><span style="color: #0000ff;">&gt;</span>  
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">password</span><span style="color: #0000ff;">&gt;</span>admin123<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">password</span><span style="color: #0000ff;">&gt;</span>  
    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">server</span><span style="color: #0000ff;">&gt;</span>   
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">server</span><span style="color: #0000ff;">&gt;</span>  
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">id</span><span style="color: #0000ff;">&gt;</span>Snapshots<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">id</span><span style="color: #0000ff;">&gt;</span>  
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">username</span><span style="color: #0000ff;">&gt;</span>admin<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">username</span><span style="color: #0000ff;">&gt;</span>  
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">password</span><span style="color: #0000ff;">&gt;</span>admin123<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">password</span><span style="color: #0000ff;">&gt;</span>  
    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">server</span><span style="color: #0000ff;">&gt;</span> </pre>
</div>